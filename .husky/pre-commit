# Get list of staged files before running formatter/linter
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACMR)

# Run format and lint
yarn format-and-lint

# Re-stage only the files that were originally staged and were modified
if [ -n "$STAGED_FILES" ]; then
  for file in $STAGED_FILES; do
    # Check if the file still exists and was modified
    if [ -f "$file" ] && git diff --name-only | grep -q "^$file$"; then
      git add "$file"
    fi
  done
fi